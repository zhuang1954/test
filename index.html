
<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è‹±æ–‡æ™‚æ…‹æ¸¬é©—ç³»çµ±</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .option-btn.selected { border-color: #3b82f6; background-color: #eff6ff; }
        .correct { background-color: #d1fae5 !important; border-color: #10b981 !important; color: #065f46; }
        .wrong { background-color: #fee2e2 !important; border-color: #ef4444 !important; color: #991b1b; }
        /* éš±è—æ»¾å‹•æ¢ä½†ä¿æŒåŠŸèƒ½ */
        .no-scrollbar::-webkit-scrollbar { display: none; }
    </style>
</head>
<body class="bg-gray-50 min-h-screen pb-10 font-sans text-gray-900">

    <div id="app" class="max-w-md mx-auto">
        <!-- Header -->
        <header class="bg-white border-b sticky top-0 z-10 p-4 flex justify-between items-center">
            <h1 class="text-xl font-bold text-blue-600">English Quiz</h1>
            <span id="q-count-badge" class="bg-blue-100 text-blue-600 text-xs px-2 py-1 rounded-full font-medium">é¡Œåº«: 0</span>
        </header>

        <!-- é¸å–®åˆ‡æ› -->
        <nav class="flex p-4 gap-2">
            <button onclick="switchTab('quiz')" id="tab-quiz" class="flex-1 py-2 rounded-lg text-center font-bold bg-blue-600 text-white shadow-sm">é€²è¡Œæ¸¬é©—</button>
            <button onclick="switchTab('import')" id="tab-import" class="flex-1 py-2 rounded-lg text-center font-bold bg-white border text-gray-600">åŒ¯å…¥/ç®¡ç†</button>
        </nav>

        <!-- æ¸¬é©—å€åŸŸ -->
        <section id="quiz-section" class="px-4">
            <div class="bg-white p-5 rounded-2xl shadow-sm border border-gray-200 mb-6">
                <label class="block text-sm font-semibold text-gray-600 mb-3">é¸æ“‡ç·´ç¿’ç¯„åœï¼š</label>
                <select id="category-filter" class="w-full p-3 border border-gray-300 rounded-xl mb-4 focus:ring-2 focus:ring-blue-500 outline-none appearance-none bg-white">
                    <option value="all">å…¨éƒ¨æ™‚æ…‹æ··åˆ</option>
                </select>
                <button onclick="startQuiz()" class="w-full bg-blue-600 text-white py-4 rounded-xl font-bold text-lg hover:bg-blue-700 active:scale-95 transition-all shadow-md">
                    é–‹å§‹éš¨æ©Ÿ 10 é¡Œ
                </button>
            </div>

            <div id="quiz-container" class="hidden">
                <div id="questions-list" class="space-y-6">
                    <!-- é¡Œç›® -->
                </div>
                <button id="submit-btn" onclick="checkAnswers()" class="w-full mt-10 mb-6 bg-green-500 text-white py-4 rounded-2xl font-bold text-lg shadow-lg">æäº¤ä¸¦æŸ¥çœ‹åˆ†æ•¸</button>
                <div id="score-display" class="hidden text-center p-6 rounded-2xl font-bold text-2xl mb-10 shadow-inner"></div>
            </div>
        </section>

        <!-- åŒ¯å…¥èˆ‡ç®¡ç†å€åŸŸ -->
        <section id="import-section" class="hidden px-4">
            <!-- æç¤ºè©å·¥å…·å€ -->
            <div class="bg-indigo-50 p-5 rounded-2xl border border-indigo-100 mb-6">
                <h3 class="font-bold text-indigo-900 mb-2 flex items-center">
                    <span class="mr-2">ğŸ’¡</span> ç¬¬ä¸€æ­¥ï¼šä½¿ç”¨ AI ç”¢ç”Ÿé¡Œç›®
                </h3>
                <p class="text-xs text-indigo-700 mb-4 leading-relaxed">
                    è¤‡è£½ä¸‹æ–¹æŒ‡ä»¤è²¼çµ¦ ChatGPTï¼Œå®ƒæœƒç‚ºä½ ç”¢ç”Ÿç¬¦åˆæ ¼å¼ä¸”éš±è—ç­”æ¡ˆçš„åŠ å¯†å­—ä¸²ã€‚
                </p>
                <div class="relative">
                    <textarea id="ai-prompt" readonly class="w-full text-[10px] bg-white border border-indigo-200 rounded-lg p-3 h-24 text-gray-500 mb-2 overflow-hidden">è«‹å¹«æˆ‘ç”¢ç”Ÿ 20 é¡Œè‹±æ–‡æ™‚æ…‹é¸æ“‡é¡Œã€‚

è«‹åš´æ ¼ä¾ç…§ä»¥ä¸‹ JSON æ ¼å¼ç”¢ç”Ÿï¼Œæœ€å¾Œå°‡ã€Œæ•´å€‹ JSON å­—ä¸²ã€è½‰æ›ç‚ºã€ŒBase64 ç·¨ç¢¼å­—ä¸²ã€çµ¦æˆ‘ï¼Œä¸è¦æä¾›æ˜æ–‡ JSONï¼Œä¹Ÿä¸è¦åˆ†æ®µã€‚

æ ¼å¼ï¼š
[{"category": "æ™‚æ…‹åç¨±", "question": "å¥å­ (____)...", "options": ["A", "B", "C", "D"], "answer": 0}]
(è¨»ï¼šanswer ç‚ºæ­£ç¢ºé¸é …çš„ç´¢å¼•å€¼ï¼Œå¾ 0 é–‹å§‹)</textarea>
                    <button onclick="copyPrompt()" class="w-full bg-indigo-600 text-white py-2 rounded-lg text-sm font-bold active:bg-indigo-800">è¤‡è£½ AI æç¤ºè©</button>
                </div>
            </div>

            <!-- åŒ¯å…¥è¼¸å…¥å€ -->
            <div class="bg-white p-5 rounded-2xl shadow-sm border border-gray-200">
                <h3 class="font-bold mb-2">ç¬¬äºŒæ­¥ï¼šåŒ¯å…¥åŠ å¯†å­—ä¸²</h3>
                <textarea id="import-data" class="w-full h-32 p-3 border border-gray-300 rounded-xl mb-4 text-xs font-mono focus:ring-2 focus:ring-blue-500 outline-none" placeholder="åœ¨æ­¤è²¼ä¸Š ChatGPT ç”¢ç”Ÿçš„ Base64 äº‚ç¢¼å­—ä¸²..."></textarea>
                <button onclick="importQuestions()" class="w-full bg-gray-900 text-white py-3 rounded-xl font-bold mb-6">ç¢ºèªåŒ¯å…¥é¡Œåº«</button>
                
                <hr class="mb-6">
                <h3 class="font-bold text-red-600 mb-2">ç®¡ç†æ•¸æ“š</h3>
                <button onclick="clearData()" class="w-full border border-red-200 text-red-500 py-3 rounded-xl text-sm font-medium">æ¸…ç©ºç›®å‰æ‰€æœ‰é¡Œåº«</button>
            </div>
        </section>
    </div>

    <script>
        let allQuestions = JSON.parse(localStorage.getItem('quiz_data_tense')) || [];
        let currentQuestions = [];
        let userAnswers = {};

        // åˆ‡æ›é ç±¤
        function switchTab(tab) {
            const isQuiz = tab === 'quiz';
            document.getElementById('quiz-section').classList.toggle('hidden', !isQuiz);
            document.getElementById('import-section').classList.toggle('hidden', isQuiz);
            
            // æŒ‰éˆ•æ¨£å¼åˆ‡æ›
            const btnQuiz = document.getElementById('tab-quiz');
            const btnImport = document.getElementById('tab-import');
            
            if(isQuiz) {
                btnQuiz.className = "flex-1 py-2 rounded-lg text-center font-bold bg-blue-600 text-white shadow-sm";
                btnImport.className = "flex-1 py-2 rounded-lg text-center font-bold bg-white border text-gray-600";
            } else {
                btnImport.className = "flex-1 py-2 rounded-lg text-center font-bold bg-blue-600 text-white shadow-sm";
                btnQuiz.className = "flex-1 py-2 rounded-lg text-center font-bold bg-white border text-gray-600";
            }
            updateUI();
        }

        // è¤‡è£½æç¤ºè©
        function copyPrompt() {
            const promptText = document.getElementById('ai-prompt');
            promptText.select();
            promptText.setSelectionRange(0, 99999); 
            navigator.clipboard.writeText(promptText.value);
            alert('æç¤ºè©å·²è¤‡è£½ï¼è«‹è²¼çµ¦ ChatGPTã€‚');
        }

        // æ›´æ–° UI ç‹€æ…‹
        function updateUI() {
            const categories = [...new Set(allQuestions.map(q => q.category))];
            const filter = document.getElementById('category-filter');
            const currentVal = filter.value;
            
            filter.innerHTML = '<option value="all">å…¨éƒ¨æ™‚æ…‹æ··åˆ</option>';
            categories.forEach(cat => {
                filter.innerHTML += `<option value="${cat}">${cat}</option>`;
            });
            filter.value = currentVal;
            
            document.getElementById('q-count-badge').innerText = `é¡Œåº«: ${allQuestions.length}`;
        }

        // åŒ¯å…¥é‚è¼¯
        function importQuestions() {
            const raw = document.getElementById('import-data').value.trim();
            if(!raw) return alert('è«‹å…ˆè²¼ä¸Šè³‡æ–™');
            try {
                const decoded = atob(raw); 
                const newData = JSON.parse(decoded);
                if(Array.isArray(newData)) {
                    allQuestions = allQuestions.concat(newData);
                    localStorage.setItem('quiz_data_tense', JSON.stringify(allQuestions));
                    alert(`æˆåŠŸåŒ¯å…¥ ${newData.length} é¡Œï¼`);
                    document.getElementById('import-data').value = '';
                    updateUI();
                }
            } catch (e) {
                alert('åŒ¯å…¥å¤±æ•—ï¼è«‹ç¢ºä¿è²¼ä¸Šçš„æ˜¯å®Œæ•´çš„ Base64 åŠ å¯†å­—ä¸²ã€‚');
            }
        }

        // æ¸…ç©ºè³‡æ–™
        function clearData() {
            if(confirm('ç¢ºå®šè¦åˆªé™¤æ‰€æœ‰å·²åŒ¯å…¥çš„é¡Œç›®å—ï¼Ÿæ­¤æ“ä½œä¸å¯é‚„åŸã€‚')) {
                allQuestions = [];
                localStorage.removeItem('quiz_data_tense');
                updateUI();
                alert('å·²æ¸…ç©ºé¡Œåº«');
            }
        }

        // é–‹å§‹æ¸¬é©—
        function startQuiz() {
            const category = document.getElementById('category-filter').value;
            let filtered = category === 'all' ? [...allQuestions] : allQuestions.filter(q => q.category === category);
            
            if (filtered.length === 0) {
                alert('ç›®å‰çš„åˆ†é¡ä¸­æ²’æœ‰é¡Œç›®ï¼Œè«‹å…ˆåˆ°åŒ¯å…¥é é¢åŠ å…¥é¡Œç›®ã€‚');
                return;
            }

            // æ´—ç‰Œä¸¦æŠ½ 10 é¡Œ
            currentQuestions = filtered.sort(() => 0.5 - Math.random()).slice(0, 10);
            userAnswers = {};
            
            renderQuiz();
            document.getElementById('quiz-container').classList.remove('hidden');
            document.getElementById('score-display').classList.add('hidden');
            window.scrollTo({ top: 400, behavior: 'smooth' });
        }

        // æ¸²æŸ“é¡Œç›®
        function renderQuiz() {
            const list = document.getElementById('questions-list');
            list.innerHTML = '';
            currentQuestions.forEach((q, idx) => {
                const qHtml = `
                    <div class="bg-white p-5 rounded-2xl shadow-sm border border-gray-100" id="q-block-${idx}">
                        <div class="flex justify-between mb-2">
                            <span class="text-xs font-bold text-blue-500 uppercase tracking-wider">${q.category}</span>
                            <span class="text-xs text-gray-400">Question ${idx+1}</span>
                        </div>
                        <p class="font-bold text-lg mb-4 text-gray-800 leading-tight">${q.question}</p>
                        <div class="space-y-3">
                            ${q.options.map((opt, optIdx) => `
                                <button onclick="selectOption(${idx}, ${optIdx})" 
                                    id="q-${idx}-opt-${optIdx}"
                                    class="option-btn w-full text-left p-4 border-2 border-gray-100 rounded-xl transition-all active:scale-[0.98] font-medium text-gray-600">
                                    <span class="inline-block w-6 text-gray-400">${String.fromCharCode(65 + optIdx)}.</span> ${opt}
                                </button>
                            `).join('')}
                        </div>
                    </div>
                `;
                list.innerHTML += qHtml;
            });
        }

        function selectOption(qIdx, optIdx) {
            userAnswers[qIdx] = optIdx;
            const buttons = document.querySelectorAll(`#q-block-${qIdx} .option-btn`);
            buttons.forEach(btn => btn.classList.remove('selected', 'border-blue-500', 'bg-blue-50', 'text-blue-700'));
            
            const selectedBtn = document.getElementById(`q-${qIdx}-opt-${optIdx}`);
            selectedBtn.classList.add('selected', 'border-blue-500', 'bg-blue-50', 'text-blue-700');
        }

        function checkAnswers() {
            const answeredCount = Object.keys(userAnswers).length;
            if (answeredCount < currentQuestions.length) {
                if(!confirm(`ä½ é‚„æœ‰ ${currentQuestions.length - answeredCount} é¡Œæ²’å¯«ï¼Œç¢ºå®šè¦äº¤å·å—ï¼Ÿ`)) return;
            }

            let score = 0;
            currentQuestions.forEach((q, idx) => {
                const correctIdx = q.answer;
                const userIdx = userAnswers[idx];
                
                // æ¨™ç¤ºæ­£ç¢ºç­”æ¡ˆ
                document.getElementById(`q-${idx}-opt-${correctIdx}`).classList.add('correct');
                
                if (userIdx === correctIdx) {
                    score++;
                } else if (userIdx !== undefined) {
                    // æ¨™ç¤ºéŒ¯èª¤ç­”æ¡ˆ
                    document.getElementById(`q-${idx}-opt-${userIdx}`).classList.add('wrong');
                }
            });

            const scoreDiv = document.getElementById('score-display');
            scoreDiv.innerText = `æ¸¬é©—å¾—åˆ†ï¼š${score} / ${currentQuestions.length}`;
            scoreDiv.className = `block text-center mt-6 p-6 rounded-2xl font-bold text-2xl ${score >= 6 ? 'bg-green-100 text-green-700' : 'bg-red-100 text-red-700'}`;
            scoreDiv.classList.remove('hidden');
            
            document.getElementById('submit-btn').innerText = "å†æ¸¬é©—ä¸€æ¬¡";
            document.getElementById('submit-btn').onclick = () => { location.reload(); };
            
            window.scrollTo({ top: document.body.scrollHeight, behavior: 'smooth' });
        }

        // åˆå§‹åŒ–
        updateUI();
    </script>
</body>
</html>
